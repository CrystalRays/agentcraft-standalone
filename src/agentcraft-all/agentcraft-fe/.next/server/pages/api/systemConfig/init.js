"use strict";(()=>{var e={};e.id=196,e.ids=[196],e.modules={8113:e=>{e.exports=require("@alicloud/fc-open20210406")},3272:e=>{e.exports=require("@alicloud/openapi-client")},487:e=>{e.exports=require("@alicloud/ram20150501")},78:e=>{e.exports=require("@alicloud/serverless20210924")},319:e=>{e.exports=require("@alicloud/sts20150401")},2151:e=>{e.exports=require("@alicloud/tea-util")},2807:e=>{e.exports=require("@alicloud/vpc20160428")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6489:(e,c,i)=>{i.r(c),i.d(c,{config:()=>p,default:()=>d,routeModule:()=>l});var r={};i.r(r),i.d(r,{default:()=>handler});var t=i(1802),a=i(7153),o=i(6249),n=i(3502);let s={regionId:"cn-hangzhou",zoneId:"cn-hangzhou-i",cidrBlock:"10.0.0.0/24",vpcId:"",vSwitchName:"agentcraft-vpc",description:"由AgentCraft创建，配置数据库使用，请谨慎删除"};async function addVswitchId(e,c,i){try{let r=c?.body?.vpcConfig||{};r.vSwitchIds.push(i);let t=c?.serviceName,a=c?.tracingConfig||{};return await e.updateService(t,{vpcConfig:r,tracingConfig:a})}catch(e){}}async function handler(e,c){let i;let r=e.headers,t=r["x-fc-account-id"]||process.env.MAIN_ACCOUNT_ID,a=r["x-fc-access-key-id"],o=r["x-fc-access-key-secret"],d=r["x-fc-security-token"],p=process.env.Region||"cn-hangzhou";a&&(i={accessKeyId:a,accessKeySecret:o,securityToken:d});let l=new n.G(i,t),u=200,v={code:200},g=process.env.beServiceName,f=process.env.beFunctionName;try{let e=await l.getFunction({serviceName:g,functionName:f,qualifier:"LATEST"}),c=e?.body?.environmentVariables?.EMBEDDING_URL,i=await l.getService({serviceName:g}),r=i?.body?.vpcConfig||{},t="";try{let e=await l.describeVpcs({vpcId:r.vpcId,regionId:p}),c=e?.body?.vpcs?.vpc[0]||{},{vpcName:i,vpcId:a}=c;t=i,s.vpcId=a,s.regionId=p,await l.createVSwitch(s)}catch(e){console.log("vswitch create error:",e)}await addVswitchId(l,i,r.vpcId),v.data={EMBEDDING_URL:c,vpcInfo:{vpcName:t,vpcId:r.vpcId}}}catch(e){u=500,v.code=u,v.error=e.message}c.status(u).json(v)}let d=(0,o.l)(r,"default"),p=(0,o.l)(r,"config"),l=new t.PagesAPIRouteModule({definition:{kind:a.x.PAGES_API,page:"/api/systemConfig/init",pathname:"/api/systemConfig/init",bundlePath:"",filename:""},userland:r})}};var c=require("../../../webpack-api-runtime.js");c.C(e);var __webpack_exec__=e=>c(c.s=e),i=c.X(0,[4222,3502],()=>__webpack_exec__(6489));module.exports=i})();