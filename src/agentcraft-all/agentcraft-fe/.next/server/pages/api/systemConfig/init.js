"use strict";(()=>{var e={};e.id=196,e.ids=[196],e.modules={8113:e=>{e.exports=require("@alicloud/fc-open20210406")},7416:e=>{e.exports=require("@alicloud/fc20230330")},3272:e=>{e.exports=require("@alicloud/openapi-client")},487:e=>{e.exports=require("@alicloud/ram20150501")},78:e=>{e.exports=require("@alicloud/serverless20210924")},319:e=>{e.exports=require("@alicloud/sts20150401")},2151:e=>{e.exports=require("@alicloud/tea-util")},2807:e=>{e.exports=require("@alicloud/vpc20160428")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6489:(e,c,t)=>{t.r(c),t.d(c,{config:()=>l,default:()=>d,routeModule:()=>p});var i={};t.r(i),t.d(i,{default:()=>handler});var r=t(1802),o=t(7153),a=t(6249),n=t(8703);let s={regionId:"cn-hangzhou",zoneId:"cn-hangzhou-j",cidrBlock:"10.2.0.0/24",vpcId:"",vSwitchName:"agentcraft-vpc",description:"由AgentCraft创建，配置数据库使用，请谨慎删除"};async function addVswitchIdV3(e,c,t){try{let i=c?.vpcConfig||{};console.log(i),i.vSwitchIds=t,c.vpcConfig=i;let r={environmentVariables:c?.environmentVariables,vpcConfig:c.vpcConfig};return await e.updateFunctionV3(c.functionName,r)}catch(e){console.log(e)}}async function handler(e,c){let t;let i=e.headers,r=process.env.FC_ACCOUNT_ID||i["x-fc-account-id"],o=process.env.ALIBABA_CLOUD_ACCESS_KEY_ID||i["x-fc-access-key-id"],a=process.env.ALIBABA_CLOUD_ACCESS_KEY_SECRET||i["x-fc-access-key-secret"],d=process.env.ALIBABA_CLOUD_SECURITY_TOKEN||i["x-fc-security-token"],l=process.env.Region||"cn-hangzhou";o&&(t={accessKeyId:o,accessKeySecret:a,securityToken:d});let p=new n.G(t,r),u=200,v={code:200},g=process.env.beFunctionName||"";try{let e=await p.getFunctionV3(g),c=e?.body||{},t=c.environmentVariables?.EMBEDDING_URL,i=c.vpcConfig||{},r="";try{let e=await p.describeVpcs({vpcId:i.vpcId,regionId:l}),t=e?.body?.vpcs?.vpc[0]||{},{vpcName:o,vpcId:a}=t;r=o,s.vpcId=a,s.regionId=l;try{await p.createVSwitch(s)}catch(e){}let n=await p.describeVpcs({vpcId:i.vpcId,regionId:l}),d=n?.body?.vpcs?.vpc[0]||{};console.log("latestVpcResult",n);let u=d?.vSwitchIds?.vSwitchId||[];u&&u.length>0&&await addVswitchIdV3(p,c,u)}catch(e){console.log("error:",e)}v.data={EMBEDDING_URL:t,vpcInfo:{vpcName:r,vpcId:i.vpcId}}}catch(e){u=500,v.code=u,v.error=e.message}c.status(u).json(v)}let d=(0,a.l)(i,"default"),l=(0,a.l)(i,"config"),p=new r.PagesAPIRouteModule({definition:{kind:o.x.PAGES_API,page:"/api/systemConfig/init",pathname:"/api/systemConfig/init",bundlePath:"",filename:""},userland:i})}};var c=require("../../../webpack-api-runtime.js");c.C(e);var __webpack_exec__=e=>c(c.s=e),t=c.X(0,[4222,8703],()=>__webpack_exec__(6489));module.exports=t})();