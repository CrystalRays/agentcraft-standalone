"use strict";(()=>{var e={};e.id=196,e.ids=[196],e.modules={8439:e=>{e.exports=require("@alicloud/eventbridge20200401")},8113:e=>{e.exports=require("@alicloud/fc-open20210406")},7416:e=>{e.exports=require("@alicloud/fc20230330")},3272:e=>{e.exports=require("@alicloud/openapi-client")},487:e=>{e.exports=require("@alicloud/ram20150501")},78:e=>{e.exports=require("@alicloud/serverless20210924")},319:e=>{e.exports=require("@alicloud/sts20150401")},2151:e=>{e.exports=require("@alicloud/tea-util")},2807:e=>{e.exports=require("@alicloud/vpc20160428")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},5611:e=>{e.exports=import("nanoid")},3325:(e,t,c)=>{c.a(e,async(e,a)=>{try{c.r(t),c.d(t,{config:()=>l,default:()=>d,routeModule:()=>p});var i=c(1802),r=c(7153),o=c(6249),n=c(2621),s=e([n]);n=(s.then?(await s)():s)[0];let d=(0,o.l)(n,"default"),l=(0,o.l)(n,"config"),p=new i.PagesAPIRouteModule({definition:{kind:r.x.PAGES_API,page:"/api/systemConfig/init",pathname:"/api/systemConfig/init",bundlePath:"",filename:""},userland:n});a()}catch(e){a(e)}})},2621:(e,t,c)=>{c.a(e,async(e,a)=>{try{c.r(t),c.d(t,{default:()=>handler});var i=c(8723),r=e([i]);async function addVswitchIdV3(e,t,c){try{let a=t?.vpcConfig||{};a.vSwitchIds=c,t.vpcConfig=a;let i={environmentVariables:t?.environmentVariables,vpcConfig:t.vpcConfig};console.log("updateFunctionConfig",i);let r=await e.updateFunctionV3(t.functionName,i);return console.log("updateResult",r),r}catch(e){console.log(e)}}async function handler(e,t){let c;let a=e.headers,r=process.env.FC_ACCOUNT_ID||a["x-fc-account-id"],o=process.env.ALIBABA_CLOUD_ACCESS_KEY_ID||a["x-fc-access-key-id"],n=process.env.ALIBABA_CLOUD_ACCESS_KEY_SECRET||a["x-fc-access-key-secret"],s=process.env.ALIBABA_CLOUD_SECURITY_TOKEN||a["x-fc-security-token"],d=process.env.Region||"cn-hangzhou";o&&(c={accessKeyId:o,accessKeySecret:n,securityToken:s});let l={regionId:d,zoneId:`${d}-j`,cidrBlock:"10.2.0.0/24",vpcId:"",vSwitchName:"agentcraft-vpc",description:"由AgentCraft创建，配置RDS PostgreSql数据库使用，请谨慎删除"},p=new i.G(c,r),u=200,v={code:200},f=process.env.beFunctionName||"";try{let e=await p.getFunctionV3(f),t=e?.body||{},c=t.environmentVariables?.EMBEDDING_URL,a=t.vpcConfig||{},i="";try{let e=await p.describeVpcs({vpcId:a.vpcId,regionId:d}),c=e?.body?.vpcs?.vpc[0]||{},{vpcName:r,vpcId:o}=c;i=r,l.vpcId=o,l.regionId=d;try{await p.createVSwitch(l)}catch(e){}let n=await p.describeVpcs({vpcId:a.vpcId,regionId:d}),s=n?.body?.vpcs?.vpc[0]||{},u=s?.vSwitchIds?.vSwitchId||[];u&&u.length>0&&await addVswitchIdV3(p,t,u)}catch(e){console.log("error:",e)}v.data={regionId:d,EMBEDDING_URL:c,vpcInfo:{vpcName:i,vpcId:a.vpcId}}}catch(e){u=500,v.code=u,v.error=e.message}t.status(u).json(v)}i=(r.then?(await r)():r)[0],a()}catch(e){a(e)}})}};var t=require("../../../webpack-api-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),c=t.X(0,[4222,8723],()=>__webpack_exec__(3325));module.exports=c})();