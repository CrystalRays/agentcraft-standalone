"use strict";(()=>{var e={};e.id=196,e.ids=[196],e.modules={8113:e=>{e.exports=require("@alicloud/fc-open20210406")},3272:e=>{e.exports=require("@alicloud/openapi-client")},487:e=>{e.exports=require("@alicloud/ram20150501")},78:e=>{e.exports=require("@alicloud/serverless20210924")},319:e=>{e.exports=require("@alicloud/sts20150401")},2151:e=>{e.exports=require("@alicloud/tea-util")},2807:e=>{e.exports=require("@alicloud/vpc20160428")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6489:(e,c,t)=>{t.r(c),t.d(c,{config:()=>l,default:()=>d,routeModule:()=>p});var i={};t.r(i),t.d(i,{default:()=>handler});var r=t(1802),a=t(7153),o=t(6249),n=t(3502);let s={regionId:"cn-hangzhou",zoneId:"cn-hangzhou-i",cidrBlock:"10.0.0.0/24",vpcId:"",vSwitchName:"agentcraft-vpc",description:"由AgentCraft创建，配置数据库使用，请谨慎删除"};async function addVswitchId(e,c,t){try{let i=c?.body?.vpcConfig||{};i.vSwitchIds.push(t);let r=c?.serviceName,a=c?.tracingConfig||{};return await e.updateService(r,{vpcConfig:i,tracingConfig:a})}catch(e){}}async function handler(e,c){let t;let i=e.headers,r=i["x-fc-account-id"]||process.env.MAIN_ACCOUNT_ID,a=i["x-fc-access-key-id"],o=i["x-fc-access-key-secret"],d=i["x-fc-security-token"],l=process.env.Region||"cn-hangzhou";a&&(t={accessKeyId:a,accessKeySecret:o,securityToken:d});let p=new n.G(t,r),u=200,v={code:200},g=process.env.beServiceName,f=process.env.beFunctionName;try{let e=await p.getFunction({serviceName:g,functionName:f,qualifier:"LATEST"}),c=e?.body?.environmentVariables?.EMBEDDING_URL,t=await p.getService({serviceName:g}),i=t?.body?.vpcConfig||{},r="";try{let e=await p.describeVpcs({vpcId:i.vpcId,regionId:l}),c=e?.body?.vpcs?.vpc[0]||{},{vpcName:a,vpcId:o}=c;r=a,s.vpcId=o,s.regionId=l;let n=await p.createVSwitch(s);console.log(n),await addVswitchId(p,t,n.VSwitchId)}catch(e){console.log("vswitch create error:",e)}v.data={EMBEDDING_URL:c,vpcInfo:{vpcName:r,vpcId:i.vpcId}}}catch(e){u=500,v.code=u,v.error=e.message}c.status(u).json(v)}let d=(0,o.l)(i,"default"),l=(0,o.l)(i,"config"),p=new r.PagesAPIRouteModule({definition:{kind:a.x.PAGES_API,page:"/api/systemConfig/init",pathname:"/api/systemConfig/init",bundlePath:"",filename:""},userland:i})}};var c=require("../../../webpack-api-runtime.js");c.C(e);var __webpack_exec__=e=>c(c.s=e),t=c.X(0,[4222,3502],()=>__webpack_exec__(6489));module.exports=t})();